exp = math.exp;

SCALING = 1e-4;

-- -----------------------------------------------------------------------------
-- lithium parameters
-- -----------------------------------------------------------------------------
d7out = 14.57;
d7ini = 1.02;
d7ini = 0.7
d7end = 14.52

Lambda   = 15.0; -- mM

-- -----------------------------------------------------------------------------
-- pH recovery amplitude
-- -----------------------------------------------------------------------------
Lambda_h = 15.2; -- mM
pH_ini = 5.92;

function get_pH_end(L)
return pH_ini + (7.40 - pH_ini) * L/(Lambda_h+L);
end

pH_end = get_pH_end(Lambda);

-- -----------------------------------------------------------------------------
-- pH recovery kinetics
-- -----------------------------------------------------------------------------
A_h = 24.7; -- in seconds
B_h = 0.034; -- in mM/L

function get_t_h(L)
return A_h/erf(B_h*L)
end

t_h = get_t_h(Lambda);   -- in seconds


-- -----------------------------------------------------------------------------
-- recycling rates
-- -----------------------------------------------------------------------------
k0     = 1.0;  -- x SCALING, per second
pH_eta = 6.39;
pw_eta = 1.70;

-- -----------------------------------------------------------------------------
-- GHK/Leak parameters
-- -----------------------------------------------------------------------------
k7 = 8; -- x SCALING, per second


F=96485.3399;
R=8.3144621;
T=273.15;
z=1;
V=-40e-3;

Theta = exp( -z*F*V/R/(T+37) );

-- -----------------------------------------------------------------------------
-- experimental speedup
-- -----------------------------------------------------------------------------
s0 = 41; 

-- ./bin/simalpha src/lithium/simalpha.lua src/lithium/doc/nhe1_delta7_full_15mM_37_v2.txt #src/lithium/data/nhe1_intake_15mM.txt
